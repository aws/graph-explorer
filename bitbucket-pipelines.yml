image: cypress/browsers:node16.17.0-chrome106
definitions:
  caches:
    pnpm: $BITBUCKET_CLONE_DIR/.pnpm-store
pipelines:
  pull-requests:
    "**": # this runs as default for any branch not elsewhere defined
      - step:
          size: 2x
          name: Build for development
          caches:
            - node
            - pnpm
          script:
            - cd packages/client
            - curl -f https://get.pnpm.io/v6.16.js | node - add --global pnpm@7
            - cat .pipelines.npmrc >> .npmrc
            - pnpm install
            - pnpm build:dev
