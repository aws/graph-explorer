{"version":3,"names":["isIdentifier","_params","node","print","typeParameters","token","_parameters","params","returnType","type","parameters","parent","paramLength","length","i","_param","space","printInnerComments","parameter","printJoin","decorators","optional","typeAnnotation","_methodHead","kind","key","word","_noLineTerminator","async","generator","computed","_predicate","predicate","_functionHead","id","FunctionExpression","body","ArrowFunctionExpression","firstParam","format","retainLines","hasTypesOrComments","ensureNoLineTerminator","param","leadingComments","trailingComments"],"sources":["../../src/generators/methods.ts"],"sourcesContent":["import type Printer from \"../printer\";\nimport { isIdentifier } from \"@babel/types\";\nimport type * as t from \"@babel/types\";\n\nexport function _params(\n  this: Printer,\n  node: t.Function | t.TSDeclareMethod | t.TSDeclareFunction,\n) {\n  this.print(node.typeParameters, node);\n  this.token(\"(\");\n  this._parameters(node.params, node);\n  this.token(\")\");\n\n  this.print(node.returnType, node, node.type === \"ArrowFunctionExpression\");\n}\n\nexport function _parameters(\n  this: Printer,\n  parameters: t.Function[\"params\"],\n  parent:\n    | t.Function\n    | t.TSIndexSignature\n    | t.TSDeclareMethod\n    | t.TSDeclareFunction\n    | t.TSFunctionType\n    | t.TSConstructorType,\n) {\n  const paramLength = parameters.length;\n  for (let i = 0; i < paramLength; i++) {\n    this._param(parameters[i], parent);\n\n    if (i < parameters.length - 1) {\n      this.token(\",\");\n      this.space();\n    }\n  }\n  if (paramLength === 0) {\n    this.printInnerComments(parent);\n  }\n}\n\nexport function _param(\n  this: Printer,\n  parameter: t.Identifier | t.RestElement | t.Pattern | t.TSParameterProperty,\n  parent?:\n    | t.Function\n    | t.TSIndexSignature\n    | t.TSDeclareMethod\n    | t.TSDeclareFunction\n    | t.TSFunctionType\n    | t.TSConstructorType,\n) {\n  this.printJoin(parameter.decorators, parameter);\n  this.print(parameter, parent);\n  if (\n    // @ts-expect-error optional is not in TSParameterProperty\n    parameter.optional\n  ) {\n    this.token(\"?\"); // TS / flow\n  }\n\n  this.print(\n    // @ts-expect-error typeAnnotation is not in TSParameterProperty\n    parameter.typeAnnotation,\n    parameter,\n  ); // TS / flow\n}\n\nexport function _methodHead(this: Printer, node: t.Method | t.TSDeclareMethod) {\n  const kind = node.kind;\n  const key = node.key;\n\n  if (kind === \"get\" || kind === \"set\") {\n    this.word(kind);\n    this.space();\n  }\n\n  const { _noLineTerminator } = this;\n  if (node.async) {\n    // ensure no line terminator between async and class element name / *\n    this._noLineTerminator = true;\n    this.word(\"async\");\n    this.space();\n  }\n\n  if (\n    kind === \"method\" ||\n    // @ts-expect-error Fixme: kind: \"init\" is not defined\n    kind === \"init\"\n  ) {\n    if (node.generator) {\n      if (node.async) {\n        this.printInnerComments(node);\n      }\n      this.token(\"*\");\n      this._noLineTerminator = _noLineTerminator;\n    }\n  }\n\n  if (node.computed) {\n    this.token(\"[\");\n    this._noLineTerminator = _noLineTerminator;\n    this.print(key, node);\n    this.token(\"]\");\n    this.printInnerComments(node);\n  } else {\n    this.print(key, node);\n    this._noLineTerminator = _noLineTerminator;\n  }\n\n  if (\n    // @ts-expect-error optional is not in ObjectMethod\n    node.optional\n  ) {\n    // TS\n    this.token(\"?\");\n  }\n\n  this._params(node);\n}\n\nexport function _predicate(\n  this: Printer,\n  node:\n    | t.FunctionDeclaration\n    | t.FunctionExpression\n    | t.ArrowFunctionExpression,\n) {\n  if (node.predicate) {\n    if (!node.returnType) {\n      this.token(\":\");\n    }\n    this.space();\n    this.print(node.predicate, node);\n  }\n}\n\nexport function _functionHead(\n  this: Printer,\n  node: t.FunctionDeclaration | t.FunctionExpression | t.TSDeclareFunction,\n) {\n  if (node.async) {\n    this.word(\"async\");\n    this.space();\n  }\n  this.word(\"function\");\n  if (node.generator) this.token(\"*\");\n  this.printInnerComments(node);\n\n  this.space();\n  if (node.id) {\n    this.print(node.id, node);\n  }\n\n  this._params(node);\n  if (node.type !== \"TSDeclareFunction\") {\n    this._predicate(node);\n  }\n}\n\nexport function FunctionExpression(this: Printer, node: t.FunctionExpression) {\n  this._functionHead(node);\n  this.space();\n  this.print(node.body, node);\n}\n\nexport { FunctionExpression as FunctionDeclaration };\n\nexport function ArrowFunctionExpression(\n  this: Printer,\n  node: t.ArrowFunctionExpression,\n) {\n  const { _noLineTerminator } = this;\n  if (node.async) {\n    this._noLineTerminator = true;\n    this.word(\"async\");\n    this.space();\n  }\n\n  // Try to avoid printing parens in simple cases, but only if we're pretty\n  // sure that they aren't needed by type annotations or potential newlines.\n  let firstParam;\n  if (\n    !this.format.retainLines &&\n    node.params.length === 1 &&\n    isIdentifier((firstParam = node.params[0])) &&\n    !hasTypesOrComments(node, firstParam)\n  ) {\n    this.print(firstParam, node);\n    this._noLineTerminator = _noLineTerminator;\n  } else {\n    this._noLineTerminator = _noLineTerminator;\n    this._params(node);\n  }\n\n  this._predicate(node);\n  this.ensureNoLineTerminator(() => {\n    this.space();\n    this.printInnerComments(node);\n    this.token(\"=>\");\n  });\n\n  this.space();\n\n  this.print(node.body, node);\n}\n\nfunction hasTypesOrComments(\n  node: t.ArrowFunctionExpression,\n  param: t.Identifier,\n): boolean {\n  return !!(\n    node.typeParameters ||\n    node.returnType ||\n    node.predicate ||\n    param.typeAnnotation ||\n    param.optional ||\n    // Flow does not support `foo /*: string*/ => {};`\n    param.leadingComments?.length ||\n    param.trailingComments?.length\n  );\n}\n"],"mappings":"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"}