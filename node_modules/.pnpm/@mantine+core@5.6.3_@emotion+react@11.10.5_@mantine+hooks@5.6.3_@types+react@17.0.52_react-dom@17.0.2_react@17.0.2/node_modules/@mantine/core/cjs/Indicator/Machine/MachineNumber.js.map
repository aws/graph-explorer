{"version":3,"file":"MachineNumber.js","sources":["../../../src/Indicator/Machine/MachineNumber.tsx"],"sourcesContent":["import React, { useState, forwardRef, useEffect, useMemo } from 'react';\nimport { usePrevious } from '@mantine/hooks';\nimport useStyles from './MachineNumber.styles';\n\ninterface MachineNumberProps {\n  value: number | string;\n  newOriginalNumber: number;\n  oldOriginalNumber: number;\n}\n\nexport const MachineNumber = forwardRef<HTMLDivElement, MachineNumberProps>((props, ref) => {\n  const [oldNumber, setOldNumber] = useState(props.value);\n  const [newNumber, setNewNumber] = useState(props.value);\n  const [scrollAnimationDirection, setScrollAnimationDirection] = useState<'up' | 'down'>('up');\n  const [isActive, setIsActive] = useState(false);\n  const prevValueRef = usePrevious(props.value);\n\n  const scrollByDir = (dir: 'up' | 'down') => {\n    setIsActive(true);\n    setScrollAnimationDirection(dir);\n    setTimeout(() => {\n      setIsActive(false);\n    }, 180);\n  };\n\n  const scroll = () => {\n    const { newOriginalNumber, oldOriginalNumber } = props;\n\n    if (newOriginalNumber == null || oldOriginalNumber == null) {\n      return;\n    }\n\n    if (newOriginalNumber > oldOriginalNumber) {\n      scrollByDir('up');\n    } else if (newOriginalNumber < oldOriginalNumber) {\n      scrollByDir('down');\n    }\n  };\n\n  useEffect(() => {\n    setOldNumber(prevValueRef);\n    setNewNumber(props.value);\n    scroll();\n  }, [props.value, prevValueRef]);\n\n  const { classes, cx } = useStyles(null, { name: 'MachineNumber' });\n\n  const newNumberScrollAnimationClass = useMemo(\n    () =>\n      isActive\n        ? scrollAnimationDirection === 'up'\n          ? classes.currentNumberScrollUp\n          : classes.currentNumberScrollDown\n        : null,\n    [isActive, scrollAnimationDirection]\n  );\n  const oldNumberScrollAnimationClass = useMemo(\n    () =>\n      isActive\n        ? scrollAnimationDirection === 'up'\n          ? classes.oldNumberScrollUp\n          : classes.oldNumberScrollDown\n        : null,\n    [isActive, scrollAnimationDirection]\n  );\n  return (\n    <span ref={ref} className={classes.baseNumber}>\n      {(oldNumber && (\n        <span\n          className={cx(classes.oldNumber, classes.currentNumberTop, oldNumberScrollAnimationClass)}\n        >\n          {oldNumber}\n        </span>\n      )) ||\n        null}\n      <span>\n        <span className={cx(classes.currentNumber, newNumberScrollAnimationClass)}>\n          {newNumber}\n        </span>\n      </span>\n      {(oldNumber && (\n        <span\n          className={cx(classes.oldNumber, classes.oldNumberBottom, oldNumberScrollAnimationClass)}\n        >\n          {oldNumber}\n        </span>\n      )) ||\n        null}\n    </span>\n  );\n});\n"],"names":["forwardRef","useState","usePrevious","useEffect","useStyles","useMemo","React"],"mappings":"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"}