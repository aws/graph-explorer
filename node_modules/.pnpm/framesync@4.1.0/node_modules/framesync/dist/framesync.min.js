!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).framesync={})}(this,function(e){"use strict";function t(e){return a=e}function n(e){return s[e].process(c)}var r=0,i="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var n=Date.now(),t=Math.max(0,16.7-(n-r));r=n+t,setTimeout(function(){return e(r)},t)},o=1/60*1e3,u=!0,a=!1,d=!1,c={delta:0,timestamp:0},f=["read","update","preRender","render","postRender"],s=f.reduce(function(e,n){var r,o,u,a,d,i,c,f,s;return e[n]=(r=t,o=[],d=!(u=[]),i=a=0,c=new WeakSet,f=new WeakSet,s={cancel:function(e){var n=u.indexOf(e);c.add(e),-1!==n&&u.splice(n,1)},process:function(e){var n,t;if(d=!0,o=(n=[u,o])[0],(u=n[1]).length=0,a=o.length)for(i=0;i<a;i++)(t=o[i])(e),!0!==f.has(t)||c.has(t)||(s.schedule(t),r(!0));d=!1},schedule:function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!1);var r=t&&d,i=r?o:u;c.delete(e),n&&f.add(e),-1===i.indexOf(e)&&(i.push(e),r&&(a=o.length))}}),e},{}),l=f.reduce(function(e,n){var r=s[n];return e[n]=function(e,n,t){return void 0===n&&(n=!1),void 0===t&&(t=!1),a||h(),r.schedule(e,n,t),e},e},{}),m=f.reduce(function(e,n){return e[n]=s[n].cancel,e},{}),p=function(e){a=!1,c.delta=u?o:Math.max(Math.min(e-c.timestamp,40),1),u||(o=c.delta),c.timestamp=e,d=!0,f.forEach(n),d=!1,a&&(u=!1,i(p))},h=function(){u=a=!0,d||i(p)};e.cancelSync=m,e.default=l,e.getFrameData=function(){return c},Object.defineProperty(e,"__esModule",{value:!0})});
