{"version":3,"file":"use-css.js","sources":["../../src/tss/use-css.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport { serializeStyles, RegisteredCache } from '@emotion/serialize';\nimport { insertStyles, getRegisteredStyles } from '@emotion/utils';\nimport type { EmotionCache } from '@emotion/cache';\nimport { useGuaranteedMemo } from './utils/use-guaranteed-memo/use-guaranteed-memo';\nimport type { CSS } from './types';\nimport { useEmotionCache } from './use-emotion-cache';\n\nconst refPropertyName = 'ref' as const;\n\nfunction getRef(args: any[]) {\n  let ref: string;\n\n  if (args.length !== 1) {\n    return { args, ref };\n  }\n\n  const [arg] = args;\n\n  if (!(arg instanceof Object)) {\n    return { args, ref };\n  }\n\n  if (!(refPropertyName in arg)) {\n    return { args, ref };\n  }\n\n  ref = arg[refPropertyName];\n  const argCopy = { ...arg };\n  delete argCopy[refPropertyName];\n  return { args: [argCopy], ref };\n}\n\nexport const { cssFactory } = (() => {\n  function merge(registered: RegisteredCache, css: CSS, className: string) {\n    const registeredStyles: string[] = [];\n\n    const rawClassName = getRegisteredStyles(registered, registeredStyles, className);\n\n    if (registeredStyles.length < 2) {\n      return className;\n    }\n\n    return rawClassName + css(registeredStyles);\n  }\n\n  function _cssFactory(params: { cache: EmotionCache }) {\n    const { cache } = params;\n\n    const css: CSS = (...styles: any) => {\n      const { ref, args } = getRef(styles);\n      const serialized = serializeStyles(args, cache.registered);\n      insertStyles(cache as any, serialized, false);\n      return `${cache.key}-${serialized.name}${ref === undefined ? '' : ` ${ref}`}`;\n    };\n\n    const cx = (...args: any) => merge(cache.registered, css, clsx(args));\n\n    return { css, cx };\n  }\n\n  return { cssFactory: _cssFactory };\n})();\n\nexport function useCss() {\n  const cache = useEmotionCache();\n  return useGuaranteedMemo(() => cssFactory({ cache }), [cache]);\n}\n"],"names":["getRegisteredStyles","serializeStyles","insertStyles","clsx","useEmotionCache","useGuaranteedMemo"],"mappings":"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"}